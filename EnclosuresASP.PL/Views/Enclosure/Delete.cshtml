<style type="text/css">
    .span-center {
        display: flex;
        justify-content: center;
        align-items: center;
    }
</style>

@model EnclosuresASP.DAL.Entities.Enclosure

@{
    ViewBag.Title = "Шкаф №" + Model.Number;
}

<div class="row">
    <h4>Удалить шкаф №@Model.Number?</h4>
    <hr />
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    <div class="form-horizontal">
        <div class="form-group">
            @Html.Label("Номер ШЭ", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(m => Model.Number, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Номер ЭЛИС", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(m => Model.ElisNumber, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Объект", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(m => Model.Object, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Принял", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(m => Model.Supervisor.EmpPosition.PosName, new { htmlAttributes = new { @class = "form-control" } })
                <br />
                @Html.DisplayFor(m => Model.Supervisor.FullName, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Дата приёмки", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(x => x.AcceptanceDate, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Пароль 1 уровня", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(m => m.Lvl1Password, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Пароль 2 уровня", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(m => m.Lvl2Password, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Пароль 3 уровня", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(m => m.Lvl3Password, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Пароль 4 уровня", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(m => m.Lvl4Password, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Пароль 5 уровня", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(m => m.Lvl5Password, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Комментарий", htmlAttributes: new { @class = "control-label col-md-4" })
            <div class="col-md-8">
                @Html.DisplayFor(m => m.Comment, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>
    </div>

    <div class="form-group">
        <div class="col-md-6 col-md-offset-2">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    Блоки
                </div>
                <table class="table table-striped">
                    <tr>
                        <th class="text-center">Тип</th>
                        <th class="text-center">UID</th>
                        <th class="text-center">Заводской №</th>
                        <th class="text-center">Версия ПО</th>
                        <th class="text-center">Комментарий</th>
                    </tr>
                    @if (Model.Blocks?.Count == 0)
                    {
                        <tr>
                            <td colspan="5" class="text-center">Нет ни одного блока</td>
                        </tr>
                    }
                    else
                    {
                        foreach (var item in Model.Blocks)
                        {
                            <tr>
                                <td class="text-center">
                                    @Html.DisplayFor(modelItem => item.BlockName.BlockName)
                                </td>
                                <td class="text-center">
                                    @Html.DisplayFor(modelItem => item.UID)
                                </td>
                                <td class="text-center">
                                    @Html.DisplayFor(modelItem => item.Number)
                                </td>
                                <td class="text-center">
                                    @Html.DisplayFor(modelItem => item.SoftwareVersion)
                                </td>
                                <td class="text-center">
                                    @Html.DisplayFor(modelItem => item.Comment)
                                </td>
                            </tr>
                        }
                    }
                </table>
            </div>
        </div>
    </div>

    <div class="form-group">
        <div class="form-group">
            <div class="col-md-offset-2 col-md-6">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        Файлы
                    </div>

                    <table class="table table-striped">
                        <tr>
                            <th class="text-center">Имя</th>
                            <th class="text-center">Размер</th>
                        </tr>
                        @if (Model.Files?.Count == 0)
                        {
                            <tr>
                                <td colspan="2" class="text-center">Не загружено ниодного файла</td>
                            </tr>
                        }
                        else
                        {
                            foreach (var item in Model.Files)
                            {
                                <tr valign="middle">
                                    <td align="center">
                                        @Html.DisplayFor(modelItem => item.Filename)
                                    </td>
                                    <td align="center">
                                        @{
                                            string size;
                                            if (item.Bytes.Length > 1048576)
                                            {
                                                size = System.Math.Round(item.Bytes.Length / 1048576.0, 2) + " МБ";
                                            }
                                            else if (item.Bytes.Length > 1024)
                                            {
                                                size = System.Math.Round(item.Bytes.Length / 1024.0, 2) + " КБ";
                                            }
                                            else
                                            {
                                                size = item.Bytes.Length + " Б";
                                            }
                                        }
                                        @Html.DisplayFor(modelItem => size)
                                    </td>
                                </tr>
                            }
                        }
                    </table>
                </div>
            </div>
        </div>

        @using (Html.BeginForm())
        {
            @Html.AntiForgeryToken()
            @Html.HiddenFor(m => m.EnclosureID)
            @Html.HiddenFor(m => m.Version)
            @Html.HiddenFor(m => m.Blocks)
            @Html.HiddenFor(m => m.Files)
            @Html.HiddenFor(m => m.Number)
            @Html.HiddenFor(m => m.ElisNumber)
            @Html.HiddenFor(m => m.AcceptanceDate)
            @Html.HiddenFor(m => m.Object)
            @Html.HiddenFor(m => m.Lvl1Password)
            @Html.HiddenFor(m => m.Lvl2Password)
            @Html.HiddenFor(m => m.Lvl3Password)
            @Html.HiddenFor(m => m.Lvl4Password)
            @Html.HiddenFor(m => m.Lvl5Password)
            @Html.HiddenFor(m => m.Supervisor)
            @Html.HiddenFor(m => m.Temporary)
            @Html.HiddenFor(m => m.Username)
            <input type="hidden" name="id" value="@Model.EnclosureID" />
            <input type="hidden" name="returnUrl" value="@ViewBag.returnUrl" />
            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <div class="btn-group">
                        <button id="deleteBtn" name="deleteBtn" class="k-primary" type="submit">Удалить</button>
                        <button id="cancelBtn" name="cancelBtn" class="k-default" type="button" data-url="@ViewBag.returnUrl">Отмена</button>
                        <script type="text/javascript">
                            $("#deleteBtn").kendoButton();
                            $("#cancelBtn").kendoButton().click(function () {
                                var url = $(this).data('url');
                                window.location.href = url;
                            });
                        </script>
                    </div>
                </div>
            </div>
        }

        
    </div>
</div>